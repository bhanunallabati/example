import requests

def trigger_brandwatch_api(queryId, startDate, endDate, headers=None):
    """
    Function to trigger the Brandwatch API based on queryId, startDate, and endDate parameters and return results.

    :param queryId: Query ID for the API request
    :param startDate: Start date parameter (e.g., '2016-05-01')
    :param endDate: End date parameter (e.g., '2016-05-02')
    :param headers: Optional dictionary of headers to include in the request
    :return: JSON response from the API
    """
    try:
        # Construct the URL with the provided parameters
        base_url = 'https://api.brandwatch.com/projects/289733322/data/mentions'
        endpoint = f"{base_url}?queryId={queryId}&startDate={startDate}&endDate={endDate}"
        
        response = requests.get(endpoint, headers=headers)
        response.raise_for_status()  # Raise HTTPError for bad responses
        return response.json()  # Return the response as a JSON object
    except requests.exceptions.RequestException as e:
        print(f"Error: {e}")
        return None

# Example usage
queryId = '348973733'
startDate = '2016-05-01'
endDate = '2016-05-02'
headers = {
    'Authorization': 'Bearer your_access_token'
}

result = trigger_brandwatch_api(queryId, startDate, endDate, headers)
if result:
    print(result)
else:
    print("Failed to retrieve data")
